var Mazo = function() {
    var Carta = require('Carta');
    var cantNumeros = 12;
    var cantPalos = 4;
    var cartasEntregadas = 0;

    var self = {
        cartas: armarMazo()
    }

    self.mezclar = function () {
        var cartas = self.cartas;
        var currentIndex = cartas.length, temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex) {

            // Pick a remaining element...
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex -= 1;

            // And swap it with the current element.
            temporaryValue = cartas[currentIndex];
            cartas[currentIndex] = cartas[randomIndex];
            cartas[randomIndex] = temporaryValue;
        }
    }

    self.pedirCarta = function () {
        var unaCarta = self.cartas[cartasEntregadas];
        cartasEntregadas++;

        return unaCarta;
    }

    function determinarPalo(numeroPalo) {
        switch (numeroPalo) {
            case 0:
                return "oro";
            case 1:
                return "copa";
            case 2:
                return "espada";
            case 3:
                return "basto";
        }
    }

    function armarMazo() {
        var cartas = [];

        for (var i = 0; i < (cantNumeros * cantPalos); i++) {
            var numeroCarta = ((i) % cantNumeros) + 1;
            var numeroPalo = Math.floor((i) / cantNumeros);
            var paloCarta = determinarPalo(numeroPalo);

            var unaCarta = new Carta.crear(numeroCarta, paloCarta)

            cartas.push(unaCarta);
        }

        return cartas;
    }

    return self;
}

module.exports.crear = Mazo; 